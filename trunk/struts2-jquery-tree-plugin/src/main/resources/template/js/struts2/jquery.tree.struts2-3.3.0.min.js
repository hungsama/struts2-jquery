/*!
 * jquery.tree.struts2.js
 *
 * Integration of trees with struts 2
 *
 * Requires use of jquery.struts2.js
 *
 * Copyright (c) 2010 Johannes Geppert http://www.jgeppert.com
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 */
(function(a){a.struts2_jquery_tree={debugPrefix:"[struts2_jquery_tree] ",tree:function(c,e){var b=this,d=null;if(!b.loadAtOnce){b.require("js/base/jquery.cookie"+b.minSuffix+".js")}b.require("js/jstree/jquery.hotkeys"+b.minSuffix+".js");b.require("js/jstree/jquery.jstree"+b.minSuffix+".js");e.plugins=[];if(e.treetheme){e.plugins.push("themes");e.themes={};e.themes.theme=e.treetheme;if(!a.scriptPath){d=""}else{d=a.scriptPath}e.themes.url=d+"js/jstree/themes/"+e.treetheme+"/style.css"}else{e.plugins.push("themeroller")}if(e.contextmenu){e.plugins.push("crrm");e.plugins.push("contextmenu")}if(e.types){e.plugins.push("types")}if(e.url){e.json_data={};e.json_data.ajax={};e.json_data.ajax.url=e.url;e.json_data.ajax.data=function(f){return{id:f.attr?f.attr("id"):0}};if(e.onsuc){e.json_data.ajax.complete=function(h,f,g){a.each(e.onsuc.split(","),function(k,j){var l={};l.data=h;l.status=f;l.request=g;b.publishTopic(c,j,l);b.publishTopic(c,e.onalw,l)})}}if(e.oncom){e.json_data.ajax.complete=function(g,f){a.each(e.oncom.split(","),function(h,j){var k={};k.request=g;k.status=f;b.publishTopic(c,j,k);b.publishTopic(c,e.onalw,k)})}}if(e.onerr){e.json_data.ajax.error=function(h,f,g){a.each(e.onerr.split(","),function(k,j){var l={};l.request=h;l.status=f;l.error=g;b.publishTopic(c,j,l);b.publishTopic(c,e.onalw,l)})}}e.plugins.push("json_data")}else{e.plugins.push("html_data")}if(e.onclick||(e.url&&e.nodeHref)){e.plugins.push("ui");c.bind("select_node.jstree",function(g,i){var h={};h.data=i;h.event=g;b.publishTopic(c,e.onclick,h);if(e.url&&e.nodeHref){var f=b.addParam(e.nodeHref,nodeHrefParamName+"="+i.rslt.obj.attr("id"));if(e.nodeTargets){a.each(e.nodeTargets.split(","),function(j,k){a(b.escId(k)).load(f)})}else{window.location.href=f}}})}if(e.openload){c.bind("loaded.jstree",function(f,g){c.jstree("open_all")})}if(e.openrefresh){c.bind("refresh.jstree",function(f,g){c.jstree("open_all")})}if(e.animation){e.plugins.push("core");e.core={};e.core.animation=e.animation}c.jstree(e)},treeitem:function(c,d){var b=this;b.anchor(c,d)}};a.extend(a.struts2_jquery_tree,a.struts2_jquery)})(jQuery);