/*
 * jquery.subscribe.1.1.min
 * 
 * Implementation of publish/subcription framework for jQuery
 * Requires use of jQuery. Tested with jQuery 1.3 and above
 *
 *
 * Copyright (c) 2008 Eric Chijioke (obinna a-t g mail dot c o m)
 *
 * 
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 */
(function(){_subscribe_topics={};_subscribe_handlers={};_subscribe_getDocumentWindow=function(a){return a.parentWindow||a.defaultView};jQuery.fn.extend({createTopic:function(a){if(a&&!_subscribe_topics[a]){_subscribe_topics[a]={};_subscribe_topics[a].objects={};_subscribe_topics[a].objects.__noId__=[]}return this},destroyTopic:function(b){if(b&&_subscribe_topics[b]){for(i in _subscribe_topics[b].objects){var a=_subscribe_topics[b].objects[i];if($.isArray(a)){if(a.length>0){for(j in a){a[j].unbind(b)}}}else{a.unbind(b,data)}}}delete _subscribe_topics[b];return this},subscribe:function(b,d,g){if(this[0]&&b&&d){this.createTopic(b);if(this.attr("id")){_subscribe_topics[b].objects[this.attr("id")]=this}else{var h=_subscribe_topics[b].objects.__noId__;if(this[0].nodeType==9){for(var a in h){var f=h[a];if(f[0].nodeType==9&&_subscribe_getDocumentWindow(this[0]).frameElement==_subscribe_getDocumentWindow(f[0]).frameElement){return this}}}var e=false;for(var c=0;c<h.length;c++){if(h[c]==this){e=true;break}}if(!e){_subscribe_topics[b].objects.__noId__.push(this)}}if(typeof(d)=="function"){this.bind(b,g,d)}else{if(typeof(d)=="string"&&typeof(_subscribe_handlers[d])=="function"){this.bind(b,g,_subscribe_handlers[d])}}}return this},unsubscribe:function(b){if(b){if(_subscribe_topics[b]){if(this.attr("id")){var a=_subscribe_topics[b].objects[this.attr("id")];if(a){delete _subscribe_topics[b].objects[this.attr("id")]}}else{var d=_subscribe_topics[b].objects.__noId__;for(var c=0;c<d.length;c++){if(d[c]==this){subscribe_topics[b].objects.__noId__.splice(index,1);break}}}}this.unbind(b)}return this},publish:function(c,f,a){if(c){this.createTopic(c);var d=function(){this.isImmediatePropagationStopped=function(){return true};(new $.Event).stopPropagation();if(this.originalEvent){this.originalEvent.isImmediatePropagationStopped=function(){return true};this.originalEvent.stopPropagation=d}};var e=jQuery.Event(c);$.extend(e,{originalEvent:a,stopPropagation:d});for(i in _subscribe_topics[c].objects){var b=_subscribe_topics[c].objects[i];if($.isArray(b)){if(b.length>0){for(j in b){b[j].trigger(e,f)}}}else{b.trigger(e,f)}}}return this},publishOnEvent:function(b,a,c){if(b&&a){this.createTopic(a);this.bind(b,c,function(d){$(this).publish(a,d.data,d)})}return this}});$.extend({subscribe:function(a,b,c){return $(document).subscribe(a,b,c)},unsubscribe:function(a,b,c){return $(document).unsubscribe(a,b,c)},subscribeHandler:function(a,b){if(a&&b&&typeof(b)=="function"){_subscribe_handlers[a]=b}return $},publish:function(a,b){return $(document).publish(a,b)},createTopic:function(a){return $(document).createTopic(a)},destroyTopic:function(a){return $(document).destroyTopic(a)}})})(jQuery);