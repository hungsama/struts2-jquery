/*
 * jquery.chart.struts2.js
 *
 * Integration of charts with struts 2
 *
 * Requires use of jquery.struts2.js
 *
 * Copyright (c) 2010 Johannes Geppert http://www.jgeppert.com
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 */
(function(a){a.struts2_jquery_chart={debugPrefix:"[struts2_jquery_chart] ",chart:function(d,e){var b=this;b.require("js/flot/jquery.flot.js");a.plot(d,e.data,e)}};a.extend(a.struts2_jquery_chart,a.struts2_jquery);a.subscribeHandler("_s2j_chart",function(d,f){var e=a.struts2_jquery;var b=a(d.target);var h={};if(f){a.extend(h,f)}if(d.data){a.extend(h,d.data)}var j=h.indicatorid;e.showIndicator(j);e.publishTopic(b,h.onalw,h);e.publishTopic(b,h.onbef,h);var g={};g.complete=e.pubCom(d.target,h.onalw,h.oncom,h.targets,j,h);g.error=e.pubErr(d.target,h.onalw,h.onerr,h.errortext,modus);g.success=function(q,k,o){var p={};p.data=q;p.status=k;p.request=o;b.data("loaded",true);if(typeof(q)=="object"||a.isArray(q)){if(typeof(q)=="object"){for(i in q){if(i){var n=q[i];if(n&&typeof(n.data)=="object"){var m=n.data;var l=[];for(x in m){if(x){l.push([x,m[x]])}}n.data=l}}}}a.plot(b,q,h)}if(h.onsuc){e.publishTopic(c,h.onsuc,p);e.publishTopic(c,h.onalw,p)}};if(h.href){g.url=h.href;g.data="";if(h.hrefparameter){g.data=h.hrefparameter}if(h.requesttype){g.type=h.requesttype}else{g.type="POST"}if(h.formids&&g.data===""){if(!e.loadAtOnce){e.require("js/plugins/jquery.form"+e.minSuffix+".js")}a.each(h.formids.split(","),function(k,m){var l=a(e.escId(m)).formSerialize();if(g.data!==""){g.data=g.data+"&"+l}else{g.data=l}})}g.dataType="json";if(!g.data){g.data={}}h.options=g;e.publishTopic(b,h.onalw,h);e.publishTopic(b,h.onbef,h);a.ajax(g)}})})(jQuery);