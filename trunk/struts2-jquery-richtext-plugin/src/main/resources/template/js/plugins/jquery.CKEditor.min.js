/*
 ### jQuery CKEditor Plugin v0.40 - 2010-03-26 ###
 * http://www.fyneworks.com/ - diego@fyneworks.com
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 ###
 Project: http://jquery.com/plugins/project/CKEditor/
 Website: http://www.fyneworks.com/jquery/CKEditor/
*/
if(window.jQuery){(function(a){a.extend(a,{ckeditor:{waitFor:10,config:{},path:"/CKEditor/",selector:"textarea.ckeditor",editors:[],loaded:false,autoIntercept:["submit","ajaxSubmit","ajaxForm","validate","valid"],intercepted:{},intercept:function(b,e,c){var g,f;c=c||[];if(c.constructor.toString().indexOf("Array")<0){c=[c]}if(typeof(b)=="function"){a.ckeditor.update();f=b.apply(e||window,c);return f}if(b.constructor.toString().indexOf("Array")<0){b=[b]}for(var d=0;d<b.length;d++){g=b[d]+"";if(g){(function(h){a.ckeditor.intercepted[h]=a.fn[h]||function(){};a.fn[h]=function(){a.ckeditor.update();f=a.ckeditor.intercepted[h].apply(this,arguments);return f}})(g)}}},instance:function(c){var b=CKEDITOR.instances[c];if(!b){b=a("#"+c.replace(/\./gi,"\\.")+"")[0];if(b){b=CKEDITOR.instances[b.id]}}return b},content:function(d,c){var b=this.instance(d);if(!b){alert('CKEditor instance "'+d+'" could not be found!');return""}if(c!=undefined){b.setData(c)}return b.getData(true)},setHTML:function(c,b){if(typeof c=="object"){b=c.html;c=c.name||c.instance}return a.ckeditor.content(c,b)},update:function(){a.ckeditor.clean();for(var c=0;c<a.ckeditor.editors.length;c++){var b=a.ckeditor.editors[c];var d=a("#"+b.replace(/\./g,"\\."));if(d.length>0){var e=this.content(b);d.val(e).text(e)}}},clean:function(){if(!window.CKEDITOR){return}for(var c=0;c<a.ckeditor.editors.length;c++){var b=a.ckeditor.editors[c];var d=a("#"+b.replace(/\./g,"\\."));var e=CKEDITOR.instances[b];if(d.length==0||!e||e.textarea!=d[0]){a.ckeditor.editors.splice(c);delete CKEDITOR.instances[b]}}},create:function(b){var d=a.extend({},a.ckeditor.config||{},b||{});a.extend(d,{selector:d.selector||a.ckeditor.selector,basePath:d.path||d.basePath||(window.CKEDITOR_BASEPATH?CKEDITOR_BASEPATH:a.ckeditor.path)});var c=d.e?a(d.e):undefined;if(!c||!c.length>0){c=a(d.selector)}if(!c||!c.length>0){return}if(!a.ckeditor.loading&&!a.ckeditor.loaded){a.ckeditor.loading=true;a.getScript(d.basePath+"ckeditor.js",function(){a.ckeditor.loaded=true})}var f=function(){if(a.ckeditor.loaded){a.ckeditor.editor(c,d)}else{if(a.ckeditor.waited<=0){alert("jQuery.CKEditor plugin error: The CKEditor script did not load.")}else{a.ckeditor.waitFor--;window.setTimeout(f,1000)}}};f(c);return c},editor:function(b,c){c=a.extend({},a.ckeditor.config||{},c||{});b=a(b);if(b.size()>0){b.each(function(g,f){if((f.tagName||"").toLowerCase()!="textarea"){return alert(["An invalid parameter has been passed to the $.CKEditor.editor function","tagName:"+f.tagName,"name:"+f.name,"id:"+f.id].join("\n"))}var e=a(f);if(!f.ckeditor){f.id=f.id||"ckeditor"+(a.ckeditor.editors.length+1);a.ckeditor.editors[a.ckeditor.editors.length]=f.id;f.name=f.name||f.id;var d=a.extend({},c,(a.meta?e.data():(a.metadata?e.metadata():null))||{});d=a.extend(d,{width:(c.width||c.Width||e.width()||"100%"),height:(c.height||c.Height||e.height()||"500px"),basePath:(c.path||c.basePath),toolbar:(c.toolbar||c.ToolbarSet||undefined)});var h=CKEDITOR.replace(f.id,d);h.textarea=f;f.ckeditor=h;e.addClass("is-ckeditor")}});a.ckeditor.clean()}return b},start:function(b){a.ckeditor.clean();a("form").not("ckeditor-intercepted").addClass("ckeditor-intercepted").submit(function(){a.ckeditor.update()});if(a.ckeditor.autoIntercept){a.ckeditor.intercept(a.ckeditor.autoIntercept);a.ckeditor.autoIntercept=null}return a.ckeditor.create(b)}}});a.extend(a.fn,{ckeditor:function(c){if(this.length==1&&this[0].id&&window.CKEDITOR){var b=CKEDITOR.instances[this[0].id];if(b==this[0]){return CKEDITOR.instances[this[0].id]}else{a.ckeditor.clean()}}return a(this).each(function(){a.ckeditor.start(a.extend({},c||{},{e:this}))})}})})(jQuery)};