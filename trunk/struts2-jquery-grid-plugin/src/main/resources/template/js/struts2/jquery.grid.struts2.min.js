/*
 * jquery.grid.struts2.min.js
 *
 * Integration of jqGrid with struts 2 
 *
 * Requires use of jquery.struts2.js
 *
 * Copyright (c) 2010 Johannes Geppert http://www.jgeppert.com
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 */
(function(a){a.struts2_jquery_grid={grid:function(c,d){s2jlog("grid for : "+d.id);a.require("i18n/grid.locale-"+a.struts2_jquery.gridLocal+".js",function(){a.jgrid.no_legacy_api=true;a.jgrid.useJSON=true});if(!a.struts2_jquery.loadAtOnce){a.require(["js/base/jquery-ui"+a.struts2_jquery.minSuffix+".js","js/plugins/jquery.jqGrid.js"])}else{a.require("js/plugins/jquery.jqGrid.js")}a.requireCss("themes/ui.jqgrid.css");var f={};a.extend(f,d);if(d.onselectrowtopics||d.editurl){f.onSelectRow=function(h){var g={};g.id=h;publishTopic(c,d.onalwaystopics,g);publishTopic(c,d.onselectrowtopics,g);if(d.editurl&&d.editinline===true){if(h&&h!==a.struts2_jquery.lastselectedrow){c.jqGrid("restoreRow",a.struts2_jquery.lastselectedrow);c.jqGrid("editRow",h,true);a.struts2_jquery.lastselectedrow=h}}}}f.loadBeforeSend=function(h){var g={};g.xhr=h;publishTopic(c,d.onalwaystopics,g);publishTopic(c,d.onbeforetopics,g)};f.onPaging=function(h){var g={};g.pgButton=h;publishTopic(c,d.onalwaystopics,g);publishTopic(c,d.onpagingtopics,g)};f.onSortCol=function(i,h,g){var j={};j.index=i;j.iCol=h;j.sortorder=g;publishTopic(c,d.onalwaystopics,j);publishTopic(c,d.onsortcoltopics,j)};f.onCellSelect=function(h,g,j,k){var i={};i.rowid=h;i.iCol=g;i.cellcontent=j;i.e=k;publishTopic(c,d.onalwaystopics,i);publishTopic(c,d.oncellselecttopics,i)};f.gridComplete=function(){var g={};publishTopic(c,d.onalwaystopics,g);publishTopic(c,d.ongridcompletetopics,g)};f.loadComplete=pubCom(c,d.onalwaystopics,d.oncompletetopics,null,null,d);f.loadError=pubErr(c,d.onalwaystopics,d.onerrortopics,d.errortext);if(d.subgrid){f.subGrid=true;f.gridview=false;f.subGridRowExpanded=function(j,i){var h=j+"_table";var g=a(escId(j));var k="<table id='"+h+"' class='scroll'></table>";if(d.subgridoptions.pager&&d.subgridoptions.pager!=""){k=k+"<div id='"+j+"_pager'></div>";d.subgridoptions.pager=j+"_pager"}if(d.subgridoptions.navigator&&d.subgridoptions.navigator!=""){k=k+"<div id='"+j+"_navigator'></div>";d.subgridoptions.navigator=j+"_navigator"}g.html(k);if(d.subgridoptions.url){var l=d.subgridoptions.url.indexOf("?");if(l>0){d.subgridoptions.url=d.subgridoptions.url.substring(0,l)}d.subgridoptions.url=d.subgridoptions.url+"?id="+i}a(escId(h)).jqGrid(d.subgridoptions)}}else{f.gridview=true}c.jqGrid(f);if(d.navigator){var b={};b.add=d.navigatoradd;b.del=d.navigatordel;b.edit=d.navigatoredit;b.refresh=d.navigatorrefresh;b.search=d.navigatorsearch;b.view=d.navigatorview;c.jqGrid("navGrid",escId(d.pager),b,d.navigatoreditoptions,d.navigatoraddoptions,d.navigatordeleteoptions,d.navigatorsearchoptions,d.navigatorviewoptions)}if(d.filter){var e={};if(d.filteroptions){e=d.filteroptions}c.jqGrid("filterToolbar",e)}}};a.extend(a.struts2_jquery_grid,a.struts2_jquery)})(jQuery);